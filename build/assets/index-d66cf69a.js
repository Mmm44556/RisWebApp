import{r as a,u as v,j as e,c as N,N as K,F as W,E as Q,a as X,b as J,R as L,_ as C,d as Y,C as O,B as Z,e as w,f as ee,g as f,s as h,h as se,M as te,i as ae,A as ne,k as oe,T as re,l as ie,m as g,O as le}from"./index-aeac18f4.js";import{D as x,u as ce,P as de,N as p,F as ue,S as me,a as he,b as xe,c as je}from"./userInitial-bff8cdd3.js";import{C as fe}from"./AbstractModalHeader-0dac5ded.js";const M=a.forwardRef(({id:t,title:s,children:n,bsPrefix:o,className:r,rootCloseEvent:i,menuRole:d,disabled:l,active:c,renderMenuOnMount:u,menuVariant:j,...T},y)=>{const S=v(void 0,"nav-item");return e.jsxs(x,{ref:y,...T,className:N(r,S),children:[e.jsx(x.Toggle,{id:t,eventKey:null,active:c,disabled:l,childBsPrefix:o,as:K,children:s}),e.jsx(x.Menu,{role:d,renderOnMount:u,rootCloseEvent:i,variant:j,children:n})]})});M.displayName="NavDropdown";const m=Object.assign(M,{Item:x.Item,ItemText:x.ItemText,Divider:x.Divider,Header:x.Header}),ge={[Q]:"showing",[X]:"showing show"},A=a.forwardRef((t,s)=>e.jsx(W,{...t,ref:s,transitionClasses:ge}));A.displayName="ToastFade";const pe=A,ve=a.createContext({onClose(){}}),H=ve,$=a.forwardRef(({bsPrefix:t,closeLabel:s="Close",closeVariant:n,closeButton:o=!0,className:r,children:i,...d},l)=>{t=v(t,"toast-header");const c=a.useContext(H),u=J(j=>{c==null||c.onClose==null||c.onClose(j)});return e.jsxs("div",{ref:l,...d,className:N(t,r),children:[i,o&&e.jsx(fe,{"aria-label":s,variant:n,onClick:u,"data-dismiss":"toast"})]})});$.displayName="ToastHeader";const Ne=$,P=a.forwardRef(({className:t,bsPrefix:s,as:n="div",...o},r)=>(s=v(s,"toast-body"),e.jsx(n,{ref:r,className:N(t,s),...o})));P.displayName="ToastBody";const Te=P,z=a.forwardRef(({bsPrefix:t,className:s,transition:n=pe,show:o=!0,animation:r=!0,delay:i=5e3,autohide:d=!1,onClose:l,onEntered:c,onExit:u,onExiting:j,onEnter:T,onEntering:y,onExited:S,bg:I,...U},V)=>{t=v(t,"toast");const E=a.useRef(i),b=a.useRef(l);a.useEffect(()=>{E.current=i,b.current=l},[i,l]);const k=ce(),F=!!(d&&o),_=a.useCallback(()=>{F&&(b.current==null||b.current())},[F]);a.useEffect(()=>{k.set(_,E.current)},[k,_]);const q=a.useMemo(()=>({onClose:l}),[l]),B=!!(n&&r),R=e.jsx("div",{...U,ref:V,className:N(t,s,I&&`bg-${I}`,!B&&(o?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"});return e.jsx(H.Provider,{value:q,children:B&&n?e.jsx(n,{in:o,onEnter:T,onEntering:y,onEntered:c,onExit:u,onExiting:j,onExited:S,unmountOnExit:!0,children:R}):R})});z.displayName="Toast";const D=Object.assign(z,{Body:Te,Header:Ne});function ye(){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"d-none d-sm-block text-center",children:Array(7).fill(0).map((t,s)=>e.jsx(de.Button,{lg:10,sm:10,xs:10,className:"mt-3 d-inline-block","aria-hidden":"true"},s))})})}L.createContext(null);const G=L.createContext("light"),Se=a.lazy(()=>C(()=>import("./index-c7a35909.js"),["assets/index-c7a35909.js","assets/index-aeac18f4.js","assets/index-6da33de9.css","assets/Modal-53bfb843.js","assets/AbstractModalHeader-0dac5ded.js"])),be=a.lazy(()=>C(()=>import("./index-4cf736ec.js"),["assets/index-4cf736ec.js","assets/index-aeac18f4.js","assets/index-6da33de9.css","assets/userInitial-bff8cdd3.js","assets/AbstractModalHeader-0dac5ded.js","assets/index.esm-8c3d7532.js","assets/ListGroup-2aa0bd9f.js"])),we=t=>()=>t(s=>(s?localStorage.setItem("theme","Dark"):localStorage.setItem("theme","Light"),!s));function Ce({normalInfo:t}){const{theme:s,setTheme:n}=a.useContext(G),{show:o,LogoutModalHandle:r}=Ee();let i=Y();return e.jsx(e.Fragment,{children:e.jsx(p,{expand:"sm",style:{zIndex:"1000"},className:"shadow p-1  rounded bg-light",collapseOnSelect:!0,children:e.jsxs(O,{children:[i.pathname.split("/").includes("dataList")?e.jsxs(e.Fragment,{children:[e.jsxs(m,{title:e.jsx("span",{type:"button",className:"btn btn-outline-secondary border-0 ",children:e.jsx(Z,{className:"fs-4"})}),id:"collasible-nav-dropdown",className:"me-3",children:[e.jsx(m.Item,{href:"#action/3.1",children:"Action"}),e.jsx(m.Item,{href:"#action/3.2",children:"Another action"}),e.jsx(m.Item,{href:"#action/3.3",children:"Something"}),e.jsx(m.Divider,{})]}),e.jsx(p.Brand,{className:"fs-5",children:e.jsxs(w.Group,{controlId:"exampleForm.ControlInput1",className:"position-relative",children:[e.jsx("div",{className:"position-absolute end-0 ",children:e.jsx(w.Label,{children:e.jsx(ee,{className:"m-2 me-3",style:{cursor:"pointer"}})})}),e.jsx(w.Control,{type:"email",placeholder:"Search"})]})})]}):null,e.jsx(p.Toggle,{"aria-controls":"responsive-navbar-nav"}),e.jsxs(p.Collapse,{id:"responsive-navbar-nav",children:[e.jsx(f,{className:"me-auto"}),e.jsxs(f,{className:h.navigator_tabs,children:[e.jsx(f.Item,{children:e.jsx(se,{variant:"light",className:"d-inline-flex ",style:{borderRadius:"50px"},onClick:we(n),children:s===!0?e.jsx(te,{}):e.jsx(ae,{})})}),e.jsx(f.Item,{children:e.jsx(a.Suspense,{fallback:e.jsx("h6",{children:"loading...."}),children:e.jsx(be,{})})}),e.jsx(f.Item,{children:e.jsxs(m,{title:e.jsxs(e.Fragment,{children:[e.jsx(ue,{bg:localStorage.getItem("figure")??"#fff",children:t.user_name.charAt(0)}),t.user_name]}),id:"navbarScrollingDropdown",children:[e.jsx(m.Item,{href:"#action3",children:"Action"}),e.jsx(m.Item,{children:e.jsx(a.Suspense,{fallback:e.jsx("h6",{children:"loading...."}),children:e.jsx(Se,{normalInfo:t,show:o,LogoutModalHandle:r})})})]})})]})]})]})})})}const Ie=a.memo(Ce);function Ee(){const[t,s]=a.useState(!1);return{show:t,LogoutModalHandle:()=>s(o=>!o)}}const ke=({showToast:t,createDetail:s,toggleShow:n})=>{const[o,r]=a.useState(h.fadeIn);return a.useEffect(()=>{const i=setTimeout(()=>r(h.fadeOut),2e3);return()=>{clearTimeout(i),r(h.fadeIn)}},[t]),e.jsx(D,{onMouseOver:()=>r(h.fadeIn),onMouseLeave:()=>r(h.fadeOut),show:t,onAnimationEnd:()=>{n()},onClose:n,bg:s.theme.toLowerCase(),className:`${o} `,style:{background:s.theme??"#ffdb36"},children:e.jsxs(D.Header,{children:[s.spinner?e.jsx(me,{animation:"border",variant:s.theme,style:{width:"1rem",height:"1rem"}}):e.jsx(ne,{}),e.jsxs("strong",{className:"me-auto",children:["系統提示-",e.jsx("span",{children:s.detail})]}),e.jsx("small",{children:s.timeStamp})]})})},Fe=a.memo(ke);function _e(){const t=oe(),{data:s,isSuccess:n,isFetching:o,status:r,fetchStatus:i}=he({queryKey:["userCtx"],queryFn:async()=>{let d=await fetch("http://localhost:3301/authentication",{credentials:"include",mode:"cors",method:"GET"});if(d.status==401){alert("登入逾時，請重新登入!"),t("/sign-in");return}const l=await d.json();return xe(l.msg)},retry:1,retryDelay:1500,refetchOnWindowFocus:!0});return{data:s,isSuccess:n,isFetching:o,status:r,fetchStatus:i}}const Be=a.lazy(()=>C(()=>import("./index-59fe3ced.js"),["assets/index-59fe3ced.js","assets/index-aeac18f4.js","assets/index-6da33de9.css","assets/index.esm-0fa41996.js"]));function He(){const[t,s]=Re(),{ToastDetail:n,setToastDetail:o}=De(),{toggleShow:r,showToast:i,setShowToast:d}=Le(),{data:l,status:c}=_e(),u=l;return e.jsx(e.Fragment,{children:e.jsx(G.Provider,{value:{theme:t,setTheme:s},children:e.jsx(re,{breakpoints:["xxxl","xxl","xl","lg","md","sm","xs","xxs"],minBreakpoint:"xxs",children:e.jsx(O,{fluid:!0,children:e.jsxs(ie,{children:[e.jsx(g,{className:h.leftBreakpoint,xl:2,as:"aside",children:e.jsx(a.Suspense,{fallback:e.jsx(ye,{}),children:l?e.jsx(Be,{userState:u}):null})}),e.jsxs(g,{xl:10,className:h.rightBreakpoint,as:"main",children:[e.jsxs(g,{children:[c=="success"?e.jsx(Ie,{normalInfo:u.normalInfo}):null,e.jsx(Fe,{showToast:i,createDetail:n,toggleShow:r})]}),e.jsx(g,{style:{minHeight:"100vh"},children:c=="success"?e.jsx(le,{context:[u,o,d,i]}):null}),e.jsxs("footer",{className:"text-end text-secondary opacity-75 ",children:[e.jsx("hr",{className:"m-1"}),e.jsxs("p",{className:"d-inline-block m-1  ",children:["Copyright © 2023 React Bootstrap. Created by Mmm44556.",e.jsx("a",{href:"https://github.com/Mmm44556/RisWebApp",target:"_blank",className:"text-secondary",children:e.jsx(je,{className:"fs-4 pb-1"})})]})]})]})]})})})})})}function Re(){const[t,s]=a.useState(()=>localStorage.getItem("theme")!=="Dark");return[t,s]}function De(){const[t,s]=a.useState({detail:"",theme:"Success",spinner:!1,timeStamp:"",show:!1});return{ToastDetail:t,setToastDetail:s}}function Le(){const[t,s]=a.useState(!1);return{toggleShow:()=>s(!t),showToast:t,setShowToast:s}}export{He as default};
